<!DOCTYPE html>
<html lang="en" dir=>

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Operating your application Pivotal Cloudfoundry makes the work of performing operations actions, such as scaling, doing a zero-downtime deploy, and managing application health very easy. In the next two labs we’ll explore Pivotal Cloudfoundry operations.
Scale the Application Up Now let’s increase the number of running application instances to 3. In each of the commands below replace workshop with the name of your deployed application:
$ cf scale -i 3 workshop Scaling app workshop in org DEMO / space gammon as nsterling@pivotal.">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="Operating Your Application" />
<meta property="og:description" content="Operating your application Pivotal Cloudfoundry makes the work of performing operations actions, such as scaling, doing a zero-downtime deploy, and managing application health very easy. In the next two labs we’ll explore Pivotal Cloudfoundry operations.
Scale the Application Up Now let’s increase the number of running application instances to 3. In each of the commands below replace workshop with the name of your deployed application:
$ cf scale -i 3 workshop Scaling app workshop in org DEMO / space gammon as nsterling@pivotal." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://nicksterling.github.io/workshops/tas/docs/operating_your_application/" />

<title>Operating Your Application | Tanzu Application Service Workshop</title>
<link rel="manifest" href="/workshops/tas/manifest.json">
<link rel="icon" href="/workshops/tas/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/workshops/tas/book.min.b3215d9d1d18d9051e7fbe8f256ff80e30f41d29073b86348e230d297b771002.css" integrity="sha256-syFdnR0Y2QUef76PJW/4DjD0HSkHO4Y0jiMNKXt3EAI=">
<script defer src="/workshops/tas/en.search.min.1e3c97c5c590f7efd500c46633a18f80c9c4aade905c70fca062a4ca035604c4.js" integrity="sha256-HjyXxcWQ9&#43;/VAMRmM6GPgMnEqt6QXHD8oGKkygNWBMQ="></script>

<script defer src="/workshops/tas/sw.min.6f778cb1cffd5da8a083f6549ff6a6e68149075c4a0d22bf6b56d20f6e160be3.js" integrity="sha256-b3eMsc/9Xaigg/ZUn/am5oFJB1xKDSK/a1bSD24WC&#43;M="></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body dir=>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/workshops/tas"><span>Tanzu Application Service Workshop</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  
  
  

  
  <ul>
    
      
    
      
        <li>
          
  
    <a href="/workshops/tas/docs/environment_setup/" class="">Environment Setup</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/workshops/tas/docs/cloudfoundry/" class="">Pushing to Cloud Foundry</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/workshops/tas/docs/services/" class="">Binding Cloudfoundry Services</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/workshops/tas/docs/operating_your_application/" class="active">Operating Your Application</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/workshops/tas/docs/monitoring_your_application/" class="">Monitoring Your Application</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/workshops/tas/docs/networking_and_policies/" class="">Networking &amp; Policies (Advanced)</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/workshops/tas/docs/data_management/" class="">Data Management (Advanced)</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/workshops/tas/docs/security/" class="">Security Documentation (Advanced)</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/workshops/tas/docs/troubleshooting/" class="">Troubleshooting App Development &amp; Health (Advanced)</a>
  

        </li>
      
    
  </ul>
  















</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/workshops/tas/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Operating Your Application</strong>

  <label for="toc-control">
    
    <img src="/workshops/tas/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#operating-your-application">Operating your application</a>
      <ul>
        <li><a href="#scale-the-application-up">Scale the Application Up</a></li>
        <li><a href="#scale-the-application-down">Scale the Application Down</a></li>
        <li><a href="#accessing-container-contents">Accessing Container Contents</a></li>
      </ul>
    </li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="operating-your-application">Operating your application</h1>
<p>Pivotal Cloudfoundry makes the work of performing operations actions, such as scaling, doing a zero-downtime deploy, and managing application health very easy. In the next two labs we’ll explore Pivotal Cloudfoundry operations.</p>
<h2 id="scale-the-application-up">Scale the Application Up</h2>
<p>Now let’s increase the number of running application instances to 3. In each of the commands below replace workshop with the name of your deployed application:</p>
<pre><code>$ cf scale -i 3 workshop
Scaling app workshop in org DEMO / space gammon as nsterling@pivotal.io...
OK
</code></pre>
<p>In reporting OK, the CLI is letting you know that the additional requested instances have been started, but they are not yet necessarily running.</p>
<p>We can determine how many instances are actually running like this:</p>
<pre><code>$ cf app workshop
Showing health and status for app workshop in org DEMO / space gammon as nsterling@pivotal.io...
OK

requested state: started
instances: 1/3
usage: 512M x 3 instances
urls: workshop.vert.fe.gopivotal.com, workshop-queasier-backup.vert.fe.gopivotal.com
last uploaded: Fri Aug 7 13:15:14 UTC 2015
stack: cflinuxfs3

     state      since                    cpu    memory           disk           details
#0   running    2015-08-07 11:33:21 AM   0.1%   477.9M of 512M   144.4M of 1G  
#1   starting   2015-08-07 12:42:56 PM   0.0%   0 of 0           0 of 0  
#2   starting   2015-08-07 12:42:56 PM   0.0%   0 of 0           0 of 0

    This application instance has completed the startup process and is actually able to accept requests.

    This application instance is still starting and will not have any requests routed to it.
</code></pre>
<p>Eventually all instances will converge to a running state:</p>
<pre><code>$ cf app workshop
Showing health and status for app workshop in org DEMO / space gammon as nsterling@pivotal.io...
OK

requested state: started
instances: 3/3
usage: 512M x 3 instances
urls: workshop.vert.fe.gopivotal.com, workshop-queasier-backup.vert.fe.gopivotal.com
last uploaded: Fri Aug 7 13:15:14 UTC 2015
stack: cflinuxfs3

     state     since                    cpu    memory           disk           details
#0   running   2015-08-07 11:33:21 AM   0.1%   477.9M of 512M   144.4M of 1G
#1   running   2015-08-07 12:43:04 PM   0.2%   396.2M of 512M   144.4M of 1G
#2   running   2015-08-07 12:43:04 PM   0.2%   394.8M of 512M   144.4M of 1G
</code></pre>
<p>Revisit the application route in the browser. Refresh several times. You should observe the instance index changing as you do so:</p>
<p>The aforementioned (Go)Router is applying a random routing algorithm to all of the application instances assigned to this route. As an instance reaches the running state, its Diego Cell registers that instance in the routing table assigned to its route by sending a message to Cloud Foundry’s message bus. All (Go)Router instances are subscribed to this channel and register the routes independently. This makes for very dynamic and rapid reconfiguration!</p>
<h2 id="scale-the-application-down">Scale the Application Down</h2>
<p>We can scale the application instances back down as easily as we scaled them up, using the same command structure:</p>
<pre><code>$ cf scale -i 1 workshop
Scaling app workshop in org DEMO / space gammon as nsterling@pivotal.io...
OK
</code></pre>
<p>Check the application status again:</p>
<pre><code>$ cf app workshop
Showing health and status for app workshop in org DEMO / space gammon as nsterling@pivotal.io...
OK

requested state: started
instances: 1/1
usage: 512M x 1 instances
urls: workshop.vert.fe.gopivotal.com, workshop-queasier-backup.vert.fe.gopivotal.com
last uploaded: Fri Aug 7 13:15:14 UTC 2015
stack: cflinuxfs3
buildpack: php-buildpack=v3.0-offline-https://github.com/cloudfoundry/php-buildpack.git#3bd15e1 open-jdk-jre=1.8.0_40 spring-auto-reconfiguration=1.7.0_RELEASE tomcat-access-logging-support=2.4.0_RELEASE tomcat-instance=8.0.21 tomcat-lifecycle-support=2.4.0_REL...

     state     since                    cpu    memory           disk           details
#0   running   2015-08-07 11:33:21 AM   0.1%   477.9M of 512M   144.4M of 1G
</code></pre>
<p>As you can see, we’re back down to only one instance running, and it is in fact the original index 0 that we started with.</p>
<p>Confirm that by again revisiting the route in the browser and checking the instance index:</p>
<p>HTTP Routing</p>
<p>There are two ways to discover what routes, or HTTP URLs, are mapped to an application The first is available via the CLI. Just type:</p>
<pre><code>$ cf app workshop
Showing health and status for app workshop in org DEMO / space DEMO as you@email.com...
OK

requested state: started
instances: 3/3
usage: 512M x 3 instances
urls: workshop-leishmanial-preobligation.vert.fe.gopivotal.com
last uploaded: Fri Sep 25 15:07:25 UTC 2015
stack: cflinuxfs3

    state     since                    cpu    memory           disk           details
#0   running   2015-09-25 11:11:33 AM   0.1%   411.6M of 512M   151.6M of 1G
</code></pre>
<p>and you’ll see the list of routes in the section that says urls.</p>
<p>The second way is via the Apps Manager UI. Click on the Workshop application to view application details. Select the Routes tab to view a list of mapped routes:</p>
<p>We can easily add an additional route by clicking on + Map a Route and supplying the new hostname:</p>
<p>Navigate to the new URL in your browser window. You should see that same application displayed!</p>
<p>We can just as easily remove a route by clicking on Unmap on the route you wish to remove.</p>
<p>If you navigate to that URL you’ll receive a HTTP 404 response</p>
<p>This is how blue-green deployments are accomplished.</p>
<h2 id="accessing-container-contents">Accessing Container Contents</h2>
<p>SSH into your app container via cf ssh APP_NAME</p>
<p>Reference: <a href="https://docs.pivotal.io/pivotalcf/customizing/diego-ssh/access-apps.html">https://docs.pivotal.io/pivotalcf/customizing/diego-ssh/access-apps.html</a></p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





  <div>
    <a class="flex align-center" href="https://github.com/nicksterling/bosh-workshop/edit/master/exampleSite/content/docs/operating_your_application.md" target="_blank" rel="noopener">
      <img src="/workshops/tas/svg/edit.svg" class="book-icon" alt="Edit" />
      <span>Edit this page</span>
    </a>
  </div>

</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#operating-your-application">Operating your application</a>
      <ul>
        <li><a href="#scale-the-application-up">Scale the Application Up</a></li>
        <li><a href="#scale-the-application-down">Scale the Application Down</a></li>
        <li><a href="#accessing-container-contents">Accessing Container Contents</a></li>
      </ul>
    </li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












